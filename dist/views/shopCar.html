<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><title>购物车</title><link rel="stylesheet" type="text/css" href="../css/common-46fe464176.css"><link rel="stylesheet" type="text/css" href="../css/shopCar-91d9a3e484.css"></head><body><header class="header"><div class="header-wrap clearfix"><a href="javascript:history.go(-1);" class="goBackBtn">&lt;</a> <span>购物车</span> <a href="/" class="indexBtn">首页</a></div></header><section><div class="cart-list"><p style="text-align: center">购物车是空的！</p></div></section><footer class="footer"><div class="footer-wrap"><div class="footer-l"><span class="footer-l-cont"><input type="checkbox" name="" class="checkbox all-checkbox"> <span>全选</span></span></div><div class="footer-m"><p>商品金额总计</p><p class="all-price">￥0.00</p></div><div class="footer-r"><span class="footer-r-cont"><input type="button" name="countBtn" class="countBtn" value="去结算"></span></div></div></footer></body></html><script type="text/javascript" src="./js/template-native.js"></script><script id="test" type="text/template"> <%for (var i=0;i<data.length;i++) {%> <div class="cart-item">
		<input type="checkbox" name="" class="checkbox checkBtn">
		<img src="/upload/<%= data[i].filepath %>"> 
		<div class="good-info">
			<p><%= data[i].name %></p>
			<p class="price"><%= data[i].price %></p>
			<span class="delBtn"></span>
		</div>
	</div> <%}%> </script><script type="text/javascript" src="/bowersrc/zepto/zepto.min.js"></script><script type="text/javascript">window.onload=function(){function t(){for(var t=0,e=$('.checkBtn[checked="true"]').siblings(".good-info").children(".price"),c=0;c<e.length;c++)t+=parseInt(e[c].innerText.slice(1)),console.log();$(".all-price").text("￥"+t)}var e=localStorage.getItem(sessionStorage.getItem("sname"));data=JSON.parse("["+e.split(/;+/g).slice(1).toString()+"]"),console.log(data);var c=template("test",{data:data});document.querySelector(".cart-list").innerHTML=c;for(var n=document.querySelectorAll(".checkbox"),o=0;o<n.length;o++)n[o].onclick=function(){this.getAttribute("checked")?this.setAttribute("checked",""):this.setAttribute("checked","true"),t()};for(var a=document.querySelectorAll(".delBtn"),o=0;o<a.length;o++)a[o].onclick=function(t){return function(){confirm("确定要删除？");data.splice(t,1),localStorage.setItem(sessionStorage.getItem("sname"),"null;"+JSON.stringify(data).slice(1,-1)),window.location="/shopCar"}}(o);var i=0;$(".all-checkbox").click(function(){0==i?($(".checkBtn").attr("checked","true"),i=1):($(".checkBtn").attr("checked",""),i=0),t()}),$(".countBtn").click(function(){for(var t=[],e=$(".checkBtn"),c=0;c<e.length;c++)e[c].getAttribute("checked")&&(t.push(data[c]),data.splice(c,1));$.post("/buy",{data:t},function(t){alert(t.message),window.location="/orderList"},"json"),localStorage.setItem(sessionStorage.getItem("sname"),"null;"+JSON.stringify(data).slice(1,-1))})}</script>